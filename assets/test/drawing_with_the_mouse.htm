<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title></title>
  <style type="text/css">
    #canvas {
      background: #ebebeb;
      cursor: crosshair;
    }
  </style>
</head>
<body>
  <p>To draw hold down the left mouse button on the gray box.</p>
  <canvas id="canvas" width="400" height="300">
    You browser doesn't support canvas!
  </canvas>
  <button id="clear">Clear</button>
  <p>
    Событие onmousemove срабатывает через раз. Рисовать с помощью мыши
    по-пиксельно не получится.
  </p>
  <script type="text/javascript">
    let $=(q)=>document.querySelector(q);
    let $$(q)=>[...document.querySelectorAll(q)];
    let cnv=$('#canvas'),ctx=cnv.getContext('2d'),mousePressed=false;
    // cnv.addEventListener('keypress',(e)=>alert(e.keyCode));
    // https://developer.mozilla.org/en-US/docs/Web/API/MouseEvent
    cnv.addEventListener('mousedown',(e)=>{
      mousePressed=true;
    });
    cnv.addEventListener('mouseup',(e)=>{
      mousePressed=false;
    });
    cnv.addEventListener('mousemove',(e)=>{
      if (mousePressed){
        console.log('Mouse Position: x=%d, y=%d', e.clientX, e.clientY);
        let imgData=ctx.getImageData(0,0,cnv.width,cnv.height);
        let i = (e.offsetY * imgData.width + e.offsetX) * 4;
        imgData.data[i+0]=0;
        imgData.data[i+1]=0;
        imgData.data[i+2]=0;
        imgData.data[i+3]=255;
        ctx.putImageData(imgData,0,0);
      }
    });
    $('#clear').addEventListener('click',(e)=>{
      // http://stackoverflow.com/questions/2142535/how-to-clear-the-canvas-for-redrawing
      ctx.clearRect(0,0,cnv.width,cnv.height);
    });
  </script>
</body>
</html>